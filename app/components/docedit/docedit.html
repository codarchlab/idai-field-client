<div class="modal-body p-0">

    <section id="document-edit-wrapper">
        <header class="overview-document-heading d-flex justify-content-between">
            <div id="type-switcher-button-container">
                <type-switcher-button [type]="documentHolder.clonedDocument.resource.type"
                                  (onTypeChanged)="changeType($event)">
                </type-switcher-button>
            </div>

            <div *ngIf="documentHolder.clonedDocument"
                  class="docedit-header-label text-truncate">
                <small *ngIf="!documentHolder.clonedDocument.resource.id" i18n="@@docedit.header.create">
                    {{projectConfiguration.getLabelForType(this.documentHolder.clonedDocument.resource.type)}}
                    in {{parentLabel}} anlegen
                </small>
                <small *ngIf="documentHolder.clonedDocument.resource.id" i18n="@@docedit.header.edit">
                    {{projectConfiguration.getLabelForType(this.documentHolder.clonedDocument.resource.type)}} bearbeiten
                </small>
                <br>
                <strong>{{documentHolder.clonedDocument.resource.identifier}}</strong>
            </div>

            <div>
                <button class="btn btn-success disabled pull-right"
                        id="document-edit-button-save-document"
                        [class.disabled]="!isChanged() || isLoading()"
                        (click)="!isChanged() || isLoading() || save()">
                    <span class="mdi mdi-content-save"></span>
                    <span class="button-label" i18n="@@buttons.save">Speichern</span>
                </button>
                <div *ngIf="showDropdownButton()"
                     ngbDropdown placement="bottom-right" class="d-inline-block">
                    <button id="document-edit-button-dropdown"
                            class="btn btn-primary"
                            [class.disabled]="isLoading()"
                            [disabled]="isLoading()"
                            ngbDropdownToggle>
                        <span class="mdi mdi-dots-vertical"></span>
                    </button>
                    <div ngbDropdownMenu id="document-edit-dropdown-menu">
                        <span id="document-edit-button-duplicate-document"
                              *ngIf="showDuplicateButton()"
                              class="dropdown-item"
                              (click)="openDuplicateModal()">
                            <span class="mdi mdi-expand-all"></span>
                            <span *ngIf="!documentHolder.clonedDocument.resource.id"
                                  class="dropdown-entry-label"
                                  i18n="@@buttons.createMultipleInstances">Mehrfach erstellen</span>
                            <span *ngIf="documentHolder.clonedDocument.resource.id"
                                  class="dropdown-entry-label"
                                  i18n="@@buttons.duplicate">Vervielfältigen</span>
                        </span>
                        <span id="document-edit-button-delete-document"
                              *ngIf="showDeleteButton()"
                              class="dropdown-item"
                              (click)="openDeleteModal()">
                            <span class="mdi mdi-delete"></span>
                            <span class="dropdown-entry-label" i18n="@@buttons.delete">Löschen</span>
                        </span>
                    </div>
                </div>
                <button class="btn btn-primary"
                        id="document-edit-button-goto-view"
                        [class.disabled]="isLoading()"
                        (click)="isLoading() || cancel()">
                    <span class="mdi mdi-close"></span>
                </button>
            </div>
        </header>
        <main>
            <div *ngIf="documentHolder.clonedDocument && !isLoading()" class="container">
                <div class="row">
                    <div class="col-md-12">
                        <ngb-tabset (tabChange)="changeActiveTab($event)" activeId="{{getActiveTab()}}">
                            <ngb-tab id="docedit-fields-tab">
                                <ng-template ngbTabTitle>
                                    <span class="mdi mdi-format-list-bulleted"></span>
                                    <span class="button-label" i18n="@@docedit.tabs.metadata">Metadaten</span>
                                </ng-template>
                                <ng-template ngbTabContent>
                                    <edit-form *ngIf="projectConfiguration" [(document)]="documentHolder.clonedDocument"
                                               [fieldDefinitions]="projectConfiguration.getFieldDefinitions
                                                    (documentHolder.clonedDocument.resource.type)">
                                    </edit-form>
                                </ng-template>
                            </ngb-tab>
                            <ngb-tab *ngIf="getRelationDefinitions() && getRelationDefinitions().length > 0"
                                     id="docedit-relations-tab">
                                <ng-template ngbTabTitle>
                                    <span class="mdi mdi-sitemap"></span>
                                    <span class="button-label" i18n="@@docedit.tabs.relations">Relationen</span>
                                </ng-template>
                                <ng-template ngbTabContent>
                                    <relations-form
                                            [(document)]="documentHolder.clonedDocument"
                                            [primary]="'identifier'"
                                            [relationDefinitions]="getRelationDefinitions()">
                                    </relations-form>
                                </ng-template>
                            </ngb-tab>

                            <ngb-tab *ngIf="showDoceditMediaTab" id="docedit-media-tab">
                                <ng-template ngbTabTitle>
                                    <span class="mdi mdi-image"></span>
                                    <span class="button-label" i18n="@@docedit.tabs.media">Medienressourcen</span>
                                </ng-template>
                                <ng-template ngbTabContent>
                                    <docedit-media-tab
                                            [(document)]="documentHolder.clonedDocument">
                                    </docedit-media-tab>
                                </ng-template>
                            </ngb-tab>

                            <ngb-tab *ngIf="documentHolder.clonedDocument._conflicts" id="docedit-conflicts-tab">
                                <ng-template ngbTabTitle>
                                    <span class="mdi mdi-alert-outline"></span>
                                    <span class="button-label" i18n="@@docedit.tabs.conflicts">Konflikte</span>
                                </ng-template>
                                <ng-template ngbTabContent>
                                    <docedit-conflicts-tab [(document)]="documentHolder.clonedDocument"
                                                       [(inspectedRevisions)]="documentHolder.inspectedRevisions">
                                    </docedit-conflicts-tab>
                                </ng-template>
                            </ngb-tab>
                        </ngb-tabset>
                    </div>
                </div>
            </div>
            <div *ngIf="isLoading()" id="loading-icon-container">
                <loading-icon [context]="'docedit'"></loading-icon>
                <div id="operation-in-progress-info" class="alert alert-primary">
                    <span *ngIf="operationInProgress === 'save'" i18n="@@docedit.loadingInfo.save">
                        Ressource wird gespeichert...
                    </span>
                    <span *ngIf="operationInProgress === 'duplicate' && !documentHolder.clonedDocument.resource.id"
                          i18n="@@docedit.loadingInfo.createMultipleInstances">
                        Ressourcen werden erstellt...
                    </span>
                    <span *ngIf="operationInProgress === 'duplicate' && documentHolder.clonedDocument.resource.id"
                          i18n="@@docedit.loadingInfo.duplicate">
                        Ressource wird vervielfältigt...
                    </span>
                    <span *ngIf="operationInProgress === 'delete'" i18n="@@docedit.loadingInfo.delete">
                        Ressource wird gelöscht...
                    </span>
                </div>
            </div>
        </main>
    </section>
</div>

